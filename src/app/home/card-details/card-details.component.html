<div class="card-details" [ngClass]="{'is-mobile': isMobile}">
  <div class="card-details__close">
    <button mat-icon-button (click)="onClose()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="card-details__content">
    <div class="card-details__main-image" [ngStyle]="{'background-image': card.imageUrl ? 'url(' + card.imageUrl + ')' : 'none'}"></div>

    <div class="card-details__content__section card-details__heading">
      <div class="card-details__title">
        <div class="card-details__name">{{ card.name }}</div>
        <div class="card-details__gender" *ngIf="card.gender === 'Male'">
          <svg height="100%" viewBox="0 0 384 384" width="100%" xmlns="http://www.w3.org/2000/svg">
            <path
              d="m383.792969 13.9375c-.175781-1.378906-.480469-2.707031-.984375-3.953125-.015625-.03125-.015625-.074219-.023438-.113281 0-.007813-.007812-.015625-.015625-.023438-.554687-1.3125-1.3125-2.503906-2.167969-3.609375-.210937-.261719-.417968-.519531-.640624-.765625-.914063-1.03125-1.90625-1.984375-3.058594-2.761718-.03125-.023438-.070313-.03125-.101563-.054688-1.113281-.734375-2.34375-1.289062-3.632812-1.726562-.320313-.113282-.632813-.210938-.960938-.296876-1.351562-.367187-2.742187-.632812-4.207031-.632812h-112c-8.832031 0-16 7.167969-16 16s7.167969 16 16 16h73.367188l-95.496094 95.496094c-25.464844-20.367188-56.816406-31.496094-89.871094-31.496094-79.398438 0-144 64.601562-144 144s64.601562 144 144 144 144-64.601562 144-144c0-33.039062-11.121094-64.382812-31.503906-89.871094l95.503906-95.503906v73.375c0 8.832031 7.167969 16 16 16s16-7.167969 16-16v-112c0-.335938-.078125-.65625-.097656-.984375-.023438-.367187-.0625-.71875-.109375-1.078125zm-239.792969 338.0625c-61.761719 0-112-50.238281-112-112s50.238281-112 112-112c29.902344 0 58.054688 11.640625 79.222656 32.734375 21.136719 21.210937 32.777344 49.363281 32.777344 79.265625 0 61.761719-50.238281 112-112 112zm0 0" />
          </svg>
        </div>
        <div class="card-details__gender" *ngIf="card.gender === 'Female'">
          <svg height="100%" viewBox="-56 0 384 384" width="100%" xmlns="http://www.w3.org/2000/svg">
            <path
              d="m272 136c0-74.992188-61.007812-136-136-136s-136 61.007812-136 136c0 69.566406 52.535156 127.015625 120 134.976562v33.023438h-32c-8.832031 0-16 7.167969-16 16s7.167969 16 16 16h32v32c0 8.832031 7.167969 16 16 16s16-7.167969 16-16v-32h32c8.832031 0 16-7.167969 16-16s-7.167969-16-16-16h-32v-33.023438c67.464844-7.960937 120-65.410156 120-134.976562zm-240 0c0-57.34375 46.65625-104 104-104s104 46.65625 104 104-46.65625 104-104 104-104-46.65625-104-104zm0 0" />
          </svg>
        </div>
      </div>
    </div>

    <div class="card-details__subheading">
      <div class="card-details__subheading__item">
        <div class="card-details__subheading__label">
          Breed
        </div>
        <div class="card-details__subheading__value">
          <div class="card-details__breed">{{ card.breed }}</div>
        </div>
      </div>
      <div class="card-details__subheading__item">
        <div class="card-details__subheading__label">
          Age
        </div>
        <div class="card-details__subheading__value">
          <div class="card-details__age">{{ card.age }}</div>
        </div>
      </div>
    </div>

    <div class="card-details__content__section card-details__description">
      <div class="card-details__description__text">
        {{ card.description || 'We don\'t have a ton of info on this dog. Tap the \'View Adoption\' button to go to the adoption page.' }}
      </div>
      <div class="card-details__available-since">
        <div class="card-details__available-since__label">
          Available Since
        </div>
        <div class="card-details__available-since__value">
          {{ card.published | date:'short' }}
        </div>
      </div>
    </div>


    <div class="card-details__content__section card-details__photos">
      <div class="card-details__photos__heading">Photos</div>
      <div class="card-details__photos__list">
        <ng-container *ngFor="let additionalMedia of card.additionalMediaUrls">
          <ng-container [ngSwitch]="additionalMedia.type">
            <div 
              *ngSwitchCase="'image'"
              class="card-details__photos__thumbnail" 
              [ngStyle]="{'background-image': additionalMedia.thumbnail ? 'url(' + additionalMedia.thumbnail + ')' : 'none'}"
              (click)="onTapThumbnail(additionalMedia)">
            </div>
            <div 
              *ngSwitchCase="'video'"
              class="card-details__photos__thumbnail card-details__photos__thumbnail--video"
              [ngStyle]="{'background-image': additionalMedia.thumbnail ? 'url(' + additionalMedia.thumbnail + ')' : 'none'}"
              (click)="onTapThumbnail(additionalMedia)">
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>

    <div class="card-details__content__section card-details__attributes">
      <div class="card-details__content__section__title">
        Health
      </div>
      <div class="card-details__table card-details__attributes__table mat-elevation-z3">
        <div class="card-details__table__row card-details__table__row--first">
          <div class="card-details__attributes__icon">
            <mat-icon>pregnant_woman</mat-icon>
          </div>
          {{ card.attributes.spayed_neutered ? 'Is Fixed' : 'Not Fixed' }}
        </div>
        <div class="card-details__table__row card-details__attributes__item">
          <div class="card-details__attributes__icon">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="currentColor"
                d="M9,22H17V19.5C19.41,17.87 21,15.12 21,12V4A2,2 0 0,0 19,2H15C13.89,2 13,2.9 13,4V12H3C3,15.09 5,18 9,19.5V22M5.29,14H18.71C18.14,15.91 16.77,17.5 15,18.33V20H11V18.33C9,18 5.86,15.91 5.29,14M15,4H19V12H15V4M16,5V8H18V5H16Z" />
            </svg>
          </div>
          {{ card.attributes.house_trained ? 'Is House Trained' : 'Not House Trained' }}
        </div>
        <div class="card-details__table__row card-details__attributes__item">
          <div class="card-details__attributes__icon">
            <mat-icon>accessible</mat-icon>
          </div>
          {{ card.attributes.special_needs ? 'Has Special Needs' : 'No Special Needs' }}
        </div>
        <div class="card-details__table__row card-details__table__row--last card-details__attributes__item card-details__attributes__item--last">
          <div class="card-details__attributes__icon">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="currentColor"
                d="M11.15,15.18L9.73,13.77L11.15,12.35L12.56,13.77L13.97,12.35L12.56,10.94L13.97,9.53L15.39,10.94L16.8,9.53L13.97,6.7L6.9,13.77L9.73,16.6L11.15,15.18M3.08,19L6.2,15.89L4.08,13.77L13.97,3.87L16.1,6L17.5,4.58L16.1,3.16L17.5,1.75L21.75,6L20.34,7.4L18.92,6L17.5,7.4L19.63,9.53L9.73,19.42L7.61,17.3L3.08,21.84V19Z" />
            </svg>
          </div>
          {{ card.attributes.shots_current ? 'Shots Are Current' : 'Shots Are Not Current'}}
        </div>
      </div>
    </div>

    <div class="card-details__content__section card-details__org-info" *ngIf="orgInfo">
      <div class="card-details__content__section__title">Contact</div>
      <div class="card-details__table mat-elevation-z3">
        <div class="card-details__table__row card-details__table__row--first" *ngIf="orgInfo.name" (click)="onOrganization()">
          <mat-icon>business</mat-icon>{{ orgInfo.name }}
        </div>
        <div class="card-details__table__row" *ngIf="orgInfo.email && isMobile" (click)="onEmail()">
          <mat-icon>email</mat-icon>{{ orgInfo.email }}
        </div>
        <div class="card-details__table__row" *ngIf="orgInfo.email && !isMobile" (click)="mailTo.click()">
          <mat-icon>email</mat-icon>{{ orgInfo.email }}
          <a #mailTo [href]="'mailto:' + orgInfo.email" style="display: hidden"></a>
        </div>
        <div class="card-details__table__row" *ngIf="orgInfo.phone && isMobile" (click)="onCall()">
          <mat-icon>call</mat-icon>{{ orgInfo.phone }}
        </div>
        <div class="card-details__table__row" *ngIf="orgInfo.phone && !isMobile" (click)="tel.click()">
          <mat-icon>call</mat-icon>{{ orgInfo.phone }}
          <a #tel [href]="'tel:' + orgInfo.phone" style="display: hidden"></a>
        </div>
        <div class="card-details__table__row card-details__table__row--last" *ngIf="isMobile && (addressInfo?.street || addressInfo?.cityStateZip)"
          (click)="onLocation()">
          <mat-icon>location_on</mat-icon>
          <span>
            <div *ngIf="addressInfo.street">{{ addressInfo.street }}</div>
            <div *ngIf="addressInfo.cityStateZip">{{ addressInfo.cityStateZip }}</div>
          </span>
        </div>
        <div class="card-details__table__row card-details__table__row--last" *ngIf="!isMobile && (addressInfo?.street || addressInfo?.cityStateZip)"
          (click)="mapsLocation.click()">
          <mat-icon>location_on</mat-icon>
          <span>
            <div *ngIf="addressInfo.street">{{ addressInfo.street }}</div>
            <div *ngIf="addressInfo.cityStateZip">{{ addressInfo.cityStateZip }}</div>
          </span>
          <a #mapsLocation [href]="'https://maps.google.com/?q=' + addressSearchQuery" target="_blank"
            style="display: hidden"></a>
        </div>
      </div>
    </div>

    <div class="card-details__content__section card-details__org-info card-details__org-info--skeleton"
      *ngIf="!orgInfo">
      <div class="card-details__content__section__title">Contact</div>
      <div class="card-details__table mat-elevation-z3">
        <div class="card-details__table__row card-details__table__row--first" style="display: flex">
          <mat-icon>business</mat-icon>
          <ion-skeleton-text animated style="margin-left: 8px; width: 50%"></ion-skeleton-text>
        </div>
        <div class="card-details__table__row" style="display: flex">
          <mat-icon>email</mat-icon>
          <ion-skeleton-text animated style="margin-left: 8px; width: 50%"></ion-skeleton-text>
        </div>
        <div class="card-details__table__row" style="display: flex">
          <mat-icon>call</mat-icon>
          <ion-skeleton-text animated style="margin-left: 8px; width: 50%"></ion-skeleton-text>
        </div>
        <div class="card-details__table__row card-details__table__row--last" style="display: flex">
          <mat-icon>location_on</mat-icon>
          <ion-skeleton-text animated style="margin-left: 8px; width: 50%"></ion-skeleton-text>
        </div>
      </div>
    </div>

    <div class="card-details__spacer"></div>

    <div class="card-details__actions mat-elevation-z3">
      <div class="card-details__view-adoption">
        <ion-button fill="solid" color="dark" (click)="onViewAdoption()">View Adoption</ion-button>
      </div>
    </div>
    <div class="card-details__last-updated">
      Last Updated {{ card.lastUpdated | date:'short' }}
    </div>
  </div>
</div>